// Retro Security Quest - Game Logic
class SecurityQuest {
    constructor() {
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.userAnswers = [];
        this.questions = [];
        this.selectedAnswer = null;
        this.gameState = 'start'; // 'start', 'playing', 'end'
        
        this.init();
    }
    
    async init() {
        try {
            // Load questions
            await this.loadQuestions();
            
            // Initialize DOM elements
            this.initializeElements();
            
            // Setup event listeners
            this.setupEventListeners();
            
            // Initialize audio
            if (window.AudioManager) {
                window.AudioManager.init();
            }
            
            // Show start screen
            this.showScreen('start');
            
        } catch (error) {
            console.error('Error initializing game:', error);
            this.showError('Σφάλμα φόρτωσης παιχνιδιού');
        }
    }
    
    async loadQuestions() {
        try {
            // Embedded questions data (Solution 2: Standalone)
            this.questions = [
                {
                    "id": 1,
                    "scene_title": "Βιβλιοθήκη Γνώσης",
                    "scene_description": "Βρίσκεσαι σε μια μεγάλη βιβλιοθήκη με έναν σοφό γέροντα που σε εισάγει στις βασικές αρχές ασφάλειας.",
                    "image_prompt": "8-bit pixel art, grand library interior filled with towering bookshelves, ένας σοφός γέροντας NPC κρατά ένα μεγάλο ανοικτό βιβλίο με το σύμβολο OWASP Top 10, ο ήρωας στέκεται απέναντί του και ακούει προσεκτικά, ατμόσφαιρα σοβαρή και μυστηριώδης, στυλ κλασικού retro adventure παιχνιδιού.",
                    "question": "Τι είναι το OWASP Top 10 και γιατί είναι σημαντικό για τον δημόσιο τομέα;",
                    "options": [
                        "Είναι μια λίστα με τα 10 πιο κρίσιμα εργαλεία ασφάλειας για τον δημόσιο τομέα που δημοσιεύεται κάθε 3 χρόνια και αποτελεί σημείο αναφοράς για την ασφάλεια των εφαρμογών του δημοσίου",
                        "Είναι η λίστα με τις 10 πιο κρίσιμες ευπάθειες ασφαλείας που δημοσιεύεται κάθε 3 χρόνια και αποτελεί σημείο αναφοράς για την ασφάλεια των εφαρμογών του δημοσίου",
                        "Είναι μια λίστα με τους 10 καλύτερους προγραμματιστές ασφάλειας που επιλέγονται από διεθνή επιτροπή και καθορίζουν τις τάσεις στην ασφάλεια εφαρμογών κάθε τρία χρόνια",
                        "Είναι μια λίστα με τα 10 πιο ασφαλή λειτουργικά συστήματα που χρησιμοποιούνται στον δημόσιο τομέα και ενημερώνεται περιοδικά για να διασφαλίζεται η προστασία των δεδομένων"
                    ],
                    "correct_answer": 1,
                    "explanation": "Το OWASP Top 10 είναι η λίστα με τις 10 πιο κρίσιμες ευπάθειες ασφαλείας που δημοσιεύεται κάθε 3 χρόνια από το Open Web Application Security Project. Για τον δημόσιο τομέα αποτελεί το σημείο αναφοράς για την ασφάλεια των εφαρμογών και πρέπει να αποτελεί βασική προδιαγραφή σε κάθε έργο ανάπτυξης."
                },
                {
                    "id": 2,
                    "scene_title": "Κάστρο - Ελαττωματικός Έλεγχος Πρόσβασης",
                    "scene_description": "Βρίσκεσαι μπροστά σε ένα κάστρο όπου ένας φρουρός φυλάει την κύρια είσοδο, αλλά κάποιος εισβάλλει από πλαϊνή πόρτα.",
                    "image_prompt": "8-bit pixel art, μπροστά από πύλη κάστρου με φρουρό NPC που φυλάει την κλειδωμένη είσοδο, ένας πονηρός rogue NPC γλιστρά από μια πλαϊνή ξεκλείδωτη πόρτα πίσω από τον φρουρό (συμβολίζοντας παραβίαση πρόσβασης), ο ήρωας το παρατηρεί έκπληκτος, μεσαιωνικό σκηνικό περιπέτειας σε ρετρό στυλ.",
                    "question": "Ποια είναι η πρώτη ευπάθεια στο OWASP Top 10 και πώς εκδηλώνεται;",
                    "options": [
                        "Η ανεπαρκής κρυπτογράφηση που επιτρέπει την υποκλοπή δεδομένων, όπως όταν τα δεδομένα μεταδίδονται χωρίς προστασία και μπορούν να διαβαστούν από τρίτους αν αλλάξει κάποιος έναν αριθμό στη διεύθυνση URL",
                        "Ο ελαττωματικός έλεγχος πρόσβασης που επιτρέπει σε μη εξουσιοδοτημένους χρήστες να δουν ευαίσθητα δεδομένα, π.χ. αλλάζοντας έναν αριθμό στη διεύθυνση URL",
                        "Η έλλειψη ενημερώσεων λογισμικού που οδηγεί σε επιθέσεις, επιτρέποντας σε μη εξουσιοδοτημένους χρήστες να εκμεταλλευτούν ευπάθειες και να αποκτήσουν πρόσβαση σε δεδομένα",
                        "Η χρήση αδύναμων κωδικών πρόσβασης από τους χρήστες, που μπορεί να οδηγήσει σε παραβίαση λογαριασμών και αποκάλυψη ευαίσθητων πληροφοριών αν κάποιος αλλάξει έναν αριθμό στη διεύθυνση URL"
                    ],
                    "correct_answer": 1,
                    "explanation": "Ο ελαττωματικός έλεγχος πρόσβασης επιτρέπει σε μη εξουσιοδοτημένους χρήστες να αποκτήσουν πρόσβαση σε ευαίσθητα δεδομένα. Π.χ. ένας πολίτης μπορεί να δει στοιχεία άλλων πολιτών αλλάζοντας απλώς έναν αριθμό στη διεύθυνση URL."
                },
                {
                    "id": 3,
                    "scene_title": "Κρύπτη Δεδομένων - Κρυπτογραφικές Αποτυχίες",
                    "scene_description": "Σε μια υπόγεια κρύπτη, ένας φύλακας εξηγεί τη σημασία της κρυπτογράφησης για την προστασία των δεδομένων.",
                    "image_prompt": "8-bit pixel art, υπόγεια κρύπτη με θησαυρούς (δεδομένα) και έναν φύλακα NPC που δείχνει ένα σπασμένο λουκέτο (κρυπτογραφική αποτυχία) και ένα ασφαλισμένο σεντούκι (σωστή κρυπτογράφηση). Ο ήρωας παρακολουθεί προσεκτικά.",
                    "question": "Τι είναι οι κρυπτογραφικές αποτυχίες και γιατί αποτελούν κίνδυνο;",
                    "options": [
                        "Είναι η αποτυχία να δημιουργηθεί αντίγραφο ασφαλείας των δεδομένων, με αποτέλεσμα τα δεδομένα να είναι εκτεθειμένα σε απώλεια ή μη εξουσιοδοτημένη πρόσβαση αν δεν προστατεύονται σωστά",
                        "Αφορούν την ανεπαρκή προστασία ευαίσθητων δεδομένων, όπως όταν κωδικοί αποθηκεύονται χωρίς κρυπτογράφηση ή όταν μεταδίδονται χωρίς προστασία",
                        "Είναι η αποτυχία να διαγραφούν παλιά δεδομένα, αφήνοντας τα εκτεθειμένα σε κινδύνους παραβίασης και μη εξουσιοδοτημένης πρόσβασης",
                        "Είναι η αποτυχία να ενημερωθεί το λογισμικό, γεγονός που μπορεί να οδηγήσει σε ευπάθειες που σχετίζονται με την προστασία των δεδομένων και να επιτρέψει την αποκάλυψη ευαίσθητων πληροφοριών"
                    ],
                    "correct_answer": 1,
                    "explanation": "Αφορούν την ανεπαρκή προστασία ευαίσθητων δεδομένων, όπως όταν κωδικοί πρόσβασης αποθηκεύονται χωρίς κρυπτογράφηση ή όταν ευαίσθητα δεδομένα μεταδίδονται χωρίς προστασία."
                },
                {
                    "id": 4,
                    "scene_title": "Αίθουσα Ελέγχου Πρόσβασης",
                    "scene_description": "Σε μια αίθουσα με πόρτες και ελεγκτές, ένας υπάλληλος εξηγεί τη διαφορά αυθεντικοποίησης και εξουσιοδότησης.",
                    "image_prompt": "8-bit pixel art, αίθουσα με πολλές πόρτες, κάθε πόρτα έχει διαφορετικό επίπεδο πρόσβασης. Ένας υπάλληλος NPC δείχνει στον ήρωα πώς ελέγχεται η ταυτότητα (αυθεντικοποίηση) και τι επιτρέπεται να κάνει (εξουσιοδότηση).",
                    "question": "Ποια είναι η διαφορά μεταξύ αυθεντικοποίησης και εξουσιοδότησης;",
                    "options": [
                        "Δεν υπάρχει διαφορά, είναι το ίδιο και οι δύο όροι χρησιμοποιούνται εναλλακτικά για να περιγράψουν τη διαδικασία ελέγχου ταυτότητας και δικαιωμάτων πρόσβασης σε συστήματα",
                        "Η αυθεντικοποίηση επαληθεύει την ταυτότητα του χρήστη, ενώ η εξουσιοδότηση καθορίζει τι επιτρέπεται να κάνει",
                        "Η αυθεντικοποίηση αφορά μόνο τους διαχειριστές και σχετίζεται με τον έλεγχο πρόσβασης σε ευαίσθητα συστήματα, ενώ η εξουσιοδότηση δεν εφαρμόζεται στους απλούς χρήστες",
                        "Η εξουσιοδότηση αφορά μόνο τους χρήστες και σχετίζεται με τα δικαιώματα που έχουν σε συγκεκριμένες λειτουργίες, χωρίς να απαιτείται έλεγχος ταυτότητας"
                    ],
                    "correct_answer": 1,
                    "explanation": "Η αυθεντικοποίηση επαληθεύει την ταυτότητα του χρήστη (\"ποιος είσαι\"), ενώ η εξουσιοδότηση καθορίζει τι επιτρέπεται να κάνει (\"τι μπορείς να κάνεις\"). Π.χ. ένας υπάλληλος μπορεί να αυθεντικοποιηθεί επιτυχώς αλλά να μην έχει εξουσιοδότηση για συγκεκριμένα έγγραφα."
                },
                {
                    "id": 5,
                    "scene_title": "Κέντρο Ασφαλείας - Πολυπαραγοντική Αυθεντικοποίηση",
                    "scene_description": "Σε ένα κέντρο ασφαλείας, ένας ειδικός δείχνει πώς λειτουργεί η πολυπαραγοντική αυθεντικοποίηση.",
                    "image_prompt": "8-bit pixel art, high-tech security center με οθόνες που δείχνουν τρεις τύπους ταυτοποίησης: password, κινητό, βιομετρικά. Ένας ειδικός NPC εξηγεί στον ήρωα τη διαδικασία MFA.",
                    "question": "Τι είναι η πολυπαραγοντική αυθεντικοποίηση (MFA) και γιατί είναι υποχρεωτική;",
                    "options": [
                        "Είναι η χρήση μόνο βιομετρικών στοιχείων, όπως δακτυλικά αποτυπώματα ή αναγνώριση προσώπου, και εφαρμόζεται σε ευαίσθητα συστήματα του δημοσίου για την προστασία των δεδομένων",
                        "Απαιτεί τουλάχιστον δύο διαφορετικούς τύπους αποδεικτικών στοιχείων και είναι υποχρεωτική για τον δημόσιο τομέα που διαχειρίζεται ευαίσθητα δεδομένα",
                        "Είναι η χρήση μόνο κωδικού πρόσβασης, ο οποίος πρέπει να αλλάζει τακτικά και να είναι πολύπλοκος για να διασφαλίζεται η προστασία των ευαίσθητων δεδομένων",
                        "Είναι η χρήση μόνο κινητού τηλεφώνου για την αποστολή κωδικών μιας χρήσης, ώστε να ενισχύεται η ασφάλεια των εφαρμογών του δημοσίου"
                    ],
                    "correct_answer": 1,
                    "explanation": "Η MFA απαιτεί τουλάχιστον δύο διαφορετικούς τύπους αποδεικτικών στοιχείων: κάτι που γνωρίζεις (κωδικός), κάτι που έχεις (κινητό) ή κάτι που είσαι (βιομετρικά). Είναι υποχρεωτική για τον δημόσιο τομέα που διαχειρίζεται ευαίσθητα δεδομένα."
                },
                {
                    "id": 6,
                    "scene_title": "Δικτυακή Πύλη - HTTPS",
                    "scene_description": "Σε μια πύλη δεδομένων, ένας τεχνικός εξηγεί τη σημασία του HTTPS για την προστασία των πολιτών.",
                    "image_prompt": "8-bit pixel art, πύλη με λουκέτο και πράσινη ένδειξη HTTPS, ένας τεχνικός NPC δείχνει στον ήρωα πώς κρυπτογραφούνται τα δεδομένα κατά τη μεταφορά.",
                    "question": "Γιατί είναι απαραίτητο το HTTPS για κάθε εφαρμογή του δημοσίου;",
                    "options": [
                        "Για να φορτώνει πιο γρήγορα η σελίδα και να βελτιώνεται η εμπειρία του χρήστη, καθώς και για να διασφαλίζεται η προστασία των προσωπικών δεδομένων κατά τη μεταφορά",
                        "Για να κρυπτογραφεί τα δεδομένα μεταξύ χρήστη και διακομιστή και επειδή είναι νομική υποχρέωση για σελίδες που συλλέγουν προσωπικά δεδομένα",
                        "Για να φαίνεται πιο επαγγελματική η σελίδα και να ενισχύεται η εμπιστοσύνη των πολιτών στις ψηφιακές υπηρεσίες του δημοσίου",
                        "Δεν είναι απαραίτητο, εκτός αν η εφαρμογή διαχειρίζεται ευαίσθητα δεδομένα ή απαιτεί αυξημένη ασφάλεια για τους χρήστες"
                    ],
                    "correct_answer": 1,
                    "explanation": "Το HTTPS κρυπτογραφεί όλα τα δεδομένα που ανταλλάσσονται μεταξύ χρήστη και διακομιστή, αποτρέποντας την υποκλοπή. Για τον δημόσιο τομέα είναι νομική υποχρέωση για κάθε σελίδα που συλλέγει προσωπικά δεδομένα."
                },
                {
                    "id": 7,
                    "scene_title": "Αίθουσα Κανονισμών - GDPR Αρχές",
                    "scene_description": "Σε μια αίθουσα με νομικά έγγραφα, ένας νομικός εξηγεί τις βασικές αρχές του GDPR.",
                    "image_prompt": "8-bit pixel art, αίθουσα με νομικά βιβλία και αφίσες με τις αρχές του GDPR, ένας νομικός NPC εξηγεί στον ήρωα τις βασικές αρχές προστασίας δεδομένων.",
                    "question": "Ποιες είναι οι βασικές αρχές του GDPR που πρέπει να εφαρμόζονται στις διαδικτυακές εφαρμογές;",
                    "options": [
                        "Νομιμότητα και διαφάνεια, περιορισμός σκοπού, ελαχιστοποίηση δεδομένων, ακρίβεια, περιορισμός περιόδου αποθήκευσης και ακεραιότητα-εμπιστευτικότητα",
                        "Μόνο η διαφάνεια, χωρίς να απαιτείται περιορισμός σκοπού, ελαχιστοποίηση δεδομένων ή άλλες αρχές που σχετίζονται με την προστασία των προσωπικών πληροφοριών",
                        "Μόνο η ελαχιστοποίηση δεδομένων, χωρίς να λαμβάνονται υπόψη οι υπόλοιπες αρχές του GDPR που αφορούν τη διαφάνεια, την ακρίβεια και την ασφάλεια των δεδομένων",
                        "Μόνο η ακρίβεια, καθώς η διατήρηση σωστών και ενημερωμένων δεδομένων είναι το μοναδικό κριτήριο για τη συμμόρφωση με τον GDPR στις διαδικτυακές εφαρμογές"
                    ],
                    "correct_answer": 0,
                    "explanation": "Νομιμότητα και διαφάνεια, περιορισμός σκοπού, ελαχιστοποίηση δεδομένων, ακρίβεια, περιορισμός περιόδου αποθήκευσης και ακεραιότητα-εμπιστευτικότητα."
                },
                {
                    "id": 8,
                    "scene_title": "Εργαστήριο Σχεδιασμού - Privacy by Design",
                    "scene_description": "Σε ένα εργαστήριο σχεδιασμού, ένας αρχιτέκτονας δείχνει πώς η προστασία δεδομένων ενσωματώνεται από την αρχή.",
                    "image_prompt": "8-bit pixel art, εργαστήριο με σχεδιαγράμματα εφαρμογών και έντονη επισήμανση σε \"Privacy by Design\", ένας αρχιτέκτονας NPC εξηγεί στον ήρωα.",
                    "question": "Τι σημαίνει \"προστασία δεδομένων από τον σχεδιασμό\" (Privacy by Design);",
                    "options": [
                        "Η προστασία των προσωπικών δεδομένων πρέπει να ενσωματώνεται στον πυρήνα του σχεδιασμού από την αρχική σύλληψη της εφαρμογής, διασφαλίζοντας ότι κάθε λειτουργία λαμβάνει υπόψη την ασφάλεια και το απόρρητο",
                        "Η προστασία των δεδομένων γίνεται μόνο μετά την υλοποίηση, όταν εντοπιστούν προβλήματα ή ευπάθειες που απαιτούν διορθωτικές ενέργειες για τη διασφάλιση της συμμόρφωσης",
                        "Η προστασία των δεδομένων αφορά μόνο τους διαχειριστές, οι οποίοι είναι υπεύθυνοι για την εφαρμογή πολιτικών ασφαλείας μετά την ολοκλήρωση της ανάπτυξης της εφαρμογής",
                        "Δεν είναι απαραίτητη, καθώς η προστασία των προσωπικών δεδομένων μπορεί να προστεθεί αργότερα χωρίς να επηρεάσει τη λειτουργικότητα της εφαρμογής"
                    ],
                    "correct_answer": 0,
                    "explanation": "Η προστασία των προσωπικών δεδομένων πρέπει να ενσωματώνεται στον πυρήνα του σχεδιασμού από την αρχική σύλληψη της εφαρμογής, όχι ως μεταγενέστερη σκέψη."
                },
                {
                    "id": 9,
                    "scene_title": "Αίθουσα Κυρώσεων - Συνέπειες GDPR",
                    "scene_description": "Σε μια αίθουσα με πινακίδες προστίμων, ένας ελεγκτής εξηγεί τις συνέπειες της μη συμμόρφωσης με τον GDPR.",
                    "image_prompt": "8-bit pixel art, αίθουσα με μεγάλες πινακίδες που γράφουν \"4% turnover\" και \"20 εκατ. ευρώ\", ένας ελεγκτής NPC εξηγεί στον ήρωα τις συνέπειες.",
                    "question": "Ποιες είναι οι συνέπειες της μη συμμόρφωσης με τον GDPR;",
                    "options": [
                        "Δεν υπάρχουν συνέπειες, καθώς ο GDPR λειτουργεί μόνο ως οδηγία και δεν επιβάλλει κυρώσεις ή πρόστιμα σε οργανισμούς που δεν συμμορφώνονται",
                        "Διοικητικά πρόστιμα έως 4% του ετήσιου κύκλου εργασιών ή 20 εκατ. ευρώ και απώλεια εμπιστοσύνης των πολιτών, υποχρέωση αναφοράς παραβίασης εντός 72 ωρών",
                        "Μόνο προειδοποίηση, χωρίς να επιβάλλονται χρηματικά πρόστιμα ή άλλες κυρώσεις σε περίπτωση παραβίασης των διατάξεων του GDPR",
                        "Μόνο απώλεια εμπιστοσύνης, χωρίς να υπάρχουν νομικές ή οικονομικές συνέπειες για τον οργανισμό που παραβιάζει τον GDPR"
                    ],
                    "correct_answer": 1,
                    "explanation": "Διοικητικά πρόστιμα έως 4% του ετήσιου κύκλου εργασιών ή 20 εκατ. ευρώ, αλλά κυρίως απώλεια εμπιστοσύνης των πολιτών. Υποχρέωση αναφοράς παραβίασης εντός 72 ωρών."
                },
                {
                    "id": 10,
                    "scene_title": "Αίθουσα Ελέγχων - Τύποι Ελέγχων Ασφαλείας",
                    "scene_description": "Σε μια αίθουσα με οθόνες και εργαλεία, ένας ελεγκτής δείχνει τους τρεις βασικούς τύπους ελέγχων ασφαλείας.",
                    "image_prompt": "8-bit pixel art, αίθουσα με τρεις σταθμούς: SAST (στατικός έλεγχος κώδικα), DAST (δυναμικός έλεγχος), και penetration testing. Ένας ελεγκτής NPC εξηγεί στον ήρωα.",
                    "question": "Ποιοι είναι οι τρεις κύριοι τύποι ελέγχων ασφαλείας;",
                    "options": [
                        "Στατικοί έλεγχοι κώδικα (SAST), δυναμικοί έλεγχοι (DAST), και έλεγχοι διείσδυσης (penetration testing)",
                        "Μόνο στατικοί έλεγχοι, οι οποίοι εξετάζουν τον πηγαίο κώδικα χωρίς να λαμβάνουν υπόψη τη λειτουργία της εφαρμογής κατά την εκτέλεση ή τις πραγματικές επιθέσεις",
                        "Μόνο δυναμικοί έλεγχοι, που επικεντρώνονται στη συμπεριφορά της εφαρμογής κατά την εκτέλεση, χωρίς να εξετάζουν τον πηγαίο κώδικα ή να προσομοιώνουν επιθέσεις",
                        "Μόνο έλεγχοι διείσδυσης, που προσομοιώνουν πραγματικές επιθέσεις χωρίς να περιλαμβάνουν ανάλυση πηγαίου κώδικα ή δυναμική αξιολόγηση της εφαρμογής"
                    ],
                    "correct_answer": 0,
                    "explanation": "Στατικοί έλεγχοι κώδικα (SAST) που εξετάζουν τον πηγαίο κώδικα, δυναμικοί έλεγχοι (DAST) που εξετάζουν την εφαρμογή εν λειτουργία, και έλεγχοι διείσδυσης που προσομοιώνουν πραγματικές επιθέσεις."
                },
                {
                    "id": 11,
                    "scene_title": "Αίθουσα Στρατηγικής - Αξιολόγηση Κινδύνων",
                    "scene_description": "Σε μια αίθουσα στρατηγικής, ένας αναλυτής δείχνει πώς γίνεται η αξιολόγηση κινδύνων.",
                    "image_prompt": "8-bit pixel art, αίθουσα με χάρτες, λίστες assets, και διαγράμματα απειλών. Ένας αναλυτής NPC εξηγεί στον ήρωα τα βήματα της αξιολόγησης κινδύνων.",
                    "question": "Τι περιλαμβάνει η διαδικασία αξιολόγησης κινδύνων;",
                    "options": [
                        "Εντοπισμό περιουσιακών στοιχείων, αναγνώριση απειλών και ευπαθειών, εκτίμηση πιθανότητας και επιπτώσεων, και καθορισμό προτεραιοτήτων αντιμετώπισης",
                        "Μόνο εκτίμηση πιθανότητας, χωρίς να λαμβάνονται υπόψη τα περιουσιακά στοιχεία, οι απειλές, οι ευπάθειες ή ο καθορισμός προτεραιοτήτων για την αντιμετώπιση των κινδύνων",
                        "Μόνο αναγνώριση απειλών, χωρίς να εξετάζεται η πιθανότητα, οι επιπτώσεις ή η ανάγκη για προτεραιοποίηση των μέτρων αντιμετώπισης",
                        "Μόνο καθορισμό προτεραιοτήτων, χωρίς να προηγείται ανάλυση των περιουσιακών στοιχείων, των απειλών ή των ευπαθειών που σχετίζονται με τον οργανισμό"
                    ],
                    "correct_answer": 0,
                    "explanation": "Εντοπισμό περιουσιακών στοιχείων, αναγνώριση απειλών και ευπαθειών, εκτίμηση πιθανότητας και επιπτώσεων, και καθορισμό προτεραιοτήτων αντιμετώπισης."
                },
                {
                    "id": 12,
                    "scene_title": "Μάχη στο Κάστρο - Εστίαση σε Μεγάλους Κινδύνους",
                    "scene_description": "Σε μια επική μάχη, ένας δράκος απειλεί το κάστρο ενώ μικρά goblins τριγυρνούν. Που πρέπει να εστιάσεις;",
                    "image_prompt": "8-bit pixel art, επικά τείχη κάστρου δέχονται επίθεση. Ένας τεράστιος δράκος (μεγάλη απειλή) πλησιάζει επιθετικά τα τείχη ενώ λίγα μικρά goblins (μικρότερα ζητήματα) τριγυρνούν κάτω. Ένας αρχηγός φρουράς NPC φωνάζει και δείχνει στον ήρωα να επικεντρωθεί πρώτα στον δράκο (υψηλού κινδύνου ευπάθεια) αφήνοντας τα goblins για μετά.",
                    "question": "Σε ποια ευρήματα ελέγχου ασφαλείας πρέπει να εστιάζουμε πρώτα;",
                    "options": [
                        "Στα ευρήματα χαμηλού κινδύνου που δεν μπορούν να εκμεταλλευτούν εύκολα και δεν οδηγούν σε σοβαρές συνέπειες όπως διαρροή προσωπικών δεδομένων",
                        "Στα ευρήματα που δεν μπορούν να εκμεταλλευτούν εύκολα, καθώς αυτά συνήθως δεν οδηγούν σε σοβαρές συνέπειες και μπορούν να αντιμετωπιστούν αργότερα χωρίς να διακυβεύεται η ασφάλεια",
                        "Στα ευρήματα υψηλού κινδύνου που μπορούν να εκμεταλλευτούν εύκολα και να οδηγήσουν σε σοβαρές συνέπειες όπως διαρροή προσωπικών δεδομένων",
                        "Σε όλα τα ευρήματα ταυτόχρονα, ανεξαρτήτως του επιπέδου κινδύνου ή της πιθανότητας εκμετάλλευσης, ώστε να διασφαλιστεί η πλήρης προστασία της εφαρμογής"
                    ],
                    "correct_answer": 2,
                    "explanation": "Στα ευρήματα υψηλού κινδύνου που μπορούν να εκμεταλλευτούν εύκολα και να οδηγήσουν σε σοβαρές συνέπειες όπως διαρροή προσωπικών δεδομένων."
                },
                {
                    "id": 13,
                    "scene_title": "Αιωρούμενα Νησιά - Επιλογές Φιλοξενίας",
                    "scene_description": "Σε έναν ουρανό με αιωρούμενα νησιά, βλέπεις τρεις επιλογές hosting για την εφαρμογή σου.",
                    "image_prompt": "8-bit pixel art, σκηνικό ουρανού με τρία αιωρούμενα νησιά που αντιπροσωπεύουν επιλογές hosting. Το ένα νησί έχει ένα οχυρό-κάστρο (ιδιόκτητο data center on-premises), το δεύτερο έχει ένα κυβερνητικό κτίριο πάνω σε σύννεφο (κυβερνητικό cloud), και το τρίτο ένα μοντέρνο τεχνολογικό πόλη-νησί στα σύννεφα (πιστοποιημένο δημόσιο cloud). Ένας οδηγός/σύμβουλος NPC στέκεται δίπλα στον ήρωα σε μια ιπτάμενη πλατφόρμα, δείχνοντας προς κάθε επιλογή και εξηγώντας.",
                    "question": "Ποιες είναι οι επιλογές φιλοξενίας για εφαρμογές του δημοσίου;",
                    "options": [
                        "Ιδιόκτητες υποδομές (on-premises), κυβερνητικό cloud (G-Cloud), ή πιστοποιημένους παρόχους cloud που πληρούν τις απαιτήσεις ασφαλείας και διατηρούν δεδομένα εντός ΕΕ",
                        "Μόνο ιδιόκτητες υποδομές που πληρούν τις απαιτήσεις ασφαλείας και διατηρούν δεδομένα εντός ΕΕ, χωρίς τη δυνατότητα χρήσης κυβερνητικού ή δημόσιου cloud για φιλοξενία εφαρμογών του δημοσίου",
                        "Μόνο δημόσιο cloud που πληροί τις απαιτήσεις ασφαλείας και διατηρεί δεδομένα εντός ΕΕ, χωρίς να επιτρέπεται η χρήση ιδιόκτητων υποδομών ή κυβερνητικού cloud για φιλοξενία εφαρμογών",
                        "Μόνο κυβερνητικό cloud (G-Cloud) που πληροί τις απαιτήσεις ασφαλείας και διατηρεί δεδομένα εντός ΕΕ, χωρίς να επιτρέπεται η χρήση ιδιόκτητων υποδομών ή δημόσιου cloud"
                    ],
                    "correct_answer": 0,
                    "explanation": "Ιδιόκτητες υποδομές (on-premises), κυβερνητικό cloud (G-Cloud), ή πιστοποιημένους παρόχους cloud που πληρούν τις απαιτήσεις ασφαλείας και διατηρούν δεδομένα εντός ΕΕ."
                },
                {
                    "id": 14,
                    "scene_title": "Εργοστάσιο Λογισμικού - Αυτοματισμοί CI/CD",
                    "scene_description": "Σε ένα αυτοματοποιημένο εργοστάσιο, βλέπεις πώς ο κώδικας μεταφέρεται αυτόματα μέσω σταθμών δοκιμής.",
                    "image_prompt": "8-bit pixel art, εσωτερικό ενός αυτοματοποιημένου εργοστασίου λογισμικού. Ένας κινούμενος μεταφορικός ιμάντας μεταφέρει κουτιά κώδικα μέσα από σταθμούς δοκιμής και ανάπτυξης με ρομποτικούς βραχίονες να δουλεύουν πάνω τους. Ένας μηχανικός NPC παρακολουθεί τις διαδικασίες και εξηγεί στον ήρωα πώς λειτουργεί η γραμμή CI/CD που μειώνει τα ανθρώπινα λάθη.",
                    "question": "Τι είναι το CI/CD και γιατί είναι σημαντικό;",
                    "options": [
                        "Είναι αυτοματοποιημένες διαδικασίες ανάπτυξης που μειώνουν τα ανθρώπινα λάθη και επιτρέπουν συχνές αλλά ελεγχόμενες ενημερώσεις, διασφαλίζοντας την ποιότητα και την ασφάλεια των εφαρμογών του δημοσίου",
                        "Είναι μόνο για δοκιμές, χωρίς να επηρεάζει τη διαδικασία ανάπτυξης ή την ποιότητα των ενημερώσεων που εφαρμόζονται στις εφαρμογές του δημοσίου",
                        "Είναι μόνο για μεγάλα έργα που απαιτούν πολύπλοκες διαδικασίες ανάπτυξης και δεν εφαρμόζεται σε μικρότερες εφαρμογές ή έργα του δημοσίου τομέα",
                        "Δεν είναι σημαντικό, καθώς οι παραδοσιακές διαδικασίες ανάπτυξης επαρκούν για τη διασφάλιση της ποιότητας και της ασφάλειας των εφαρμογών του δημοσίου"
                    ],
                    "correct_answer": 0,
                    "explanation": "Continuous Integration/Continuous Deployment - αυτοματοποιημένες διαδικασίες ανάπτυξης που μειώνουν τα ανθρώπινα λάθη και επιτρέπουν συχνές αλλά ελεγχόμενες ενημερώσεις."
                },
                {
                    "id": 15,
                    "scene_title": "Αγώνας Ταχύτητας - Βελτιστοποίηση Επιδόσεων",
                    "scene_description": "Σε μια ψηφιακή πίστα, ένας γρήγορος server συναγωνίζεται με έναν αργό υπολογιστή.",
                    "image_prompt": "8-bit pixel art, ψηφιακή πίστα αγώνων ταχύτητας. Στη μία λωρίδα τρέχει ένας κομψός server-χαρακτήρας με ταχύτητα (βελτιστοποιημένη εφαρμογή), στην άλλη λωρίδα ένας αργός παλιός υπολογιστής-χαρακτήρας μένει πίσω με ιδρώτα. Θεατές NPC (πολίτες) ζητωκραυγάζουν τον γρήγορο και δυσανασχετούν με τον αργό.",
                    "question": "Γιατί η βελτιστοποίηση επιδόσεων επηρεάζει την επιτυχία των ψηφιακών υπηρεσιών;",
                    "options": [
                        "Γιατί κάνει την εφαρμογή πιο περίπλοκη και απαιτεί επιπλέον πόρους για τη διαχείριση της ταχύτητας και της απόδοσης, γεγονός που μπορεί να αποθαρρύνει τους πολίτες από τη χρήση των υπηρεσιών",
                        "Γιατί μια αργή εφαρμογή αποθαρρύνει τους πολίτες από τη χρήση ψηφιακών υπηρεσιών και τους οδηγεί πίσω στις παραδοσιακές διαδικασίες",
                        "Γιατί αυξάνει το κόστος ανάπτυξης και συντήρησης των ψηφιακών υπηρεσιών, καθιστώντας τις λιγότερο ελκυστικές για τους πολίτες και τους φορείς του δημοσίου",
                        "Δεν επηρεάζει την επιτυχία των ψηφιακών υπηρεσιών, καθώς οι πολίτες θα συνεχίσουν να τις χρησιμοποιούν ανεξάρτητα από την ταχύτητα ή την απόδοση της εφαρμογής"
                    ],
                    "correct_answer": 1,
                    "explanation": "Μια αργή εφαρμογή αποθαρρύνει τους πολίτες από τη χρήση ψηφιακών υπηρεσιών και τους οδηγεί πίσω στις παραδοσιακές, χρονοβόρες διαδικασίες."
                },
                {
                    "id": 16,
                    "scene_title": "Βιβλιοθήκη Αρχείων - Τεκμηρίωση",
                    "scene_description": "Σε μια παλιά βιβλιοθήκη, ένας αρχειοφύλακας δείχνει τη σημασία της καλής τεκμηρίωσης.",
                    "image_prompt": "8-bit pixel art, σκονισμένο αρχείο/βιβλιοθήκη με ράφια γεμάτα φακέλους και εγχειρίδια. Ένας σοφός αρχειοφύλακας NPC δείχνει στον ήρωα ένα καλά οργανωμένο ράφι με την ένδειξη \"Τεκμηρίωση Συστήματος\".",
                    "question": "Γιατί η τεκμηρίωση είναι κρίσιμη για τις εφαρμογές του δημοσίου;",
                    "options": [
                        "Γιατί οι εφαρμογές μπορεί να λειτουργούν για δεκαετίες και να διαχειρίζονται από διαφορετικές ομάδες. Η ολοκληρωμένη τεκμηρίωση διασφαλίζει τη συνέχεια και την ασφάλεια.",
                        "Για να φαίνεται πιο επαγγελματικό το έργο και να ενισχύεται η εικόνα του δημοσίου τομέα προς τους πολίτες και τους συνεργάτες",
                        "Για να μειωθεί το κόστος ανάπτυξης και συντήρησης των εφαρμογών, διευκολύνοντας την εργασία των προγραμματιστών και των διαχειριστών",
                        "Δεν είναι κρίσιμη, καθώς οι εφαρμογές μπορούν να λειτουργούν χωρίς τεκμηρίωση και να διαχειρίζονται αποτελεσματικά από τις ομάδες του δημοσίου"
                    ],
                    "correct_answer": 0,
                    "explanation": "Οι εφαρμογές μπορεί να λειτουργούν για δεκαετίες και να διαχειρίζονται από διαφορετικές ομάδες. Η ολοκληρωμένη τεκμηρίωση διασφαλίζει τη συνέχεια και την ασφάλεια."
                },
                {
                    "id": 17,
                    "scene_title": "Εργαστήριο Συντήρησης - Προγραμματισμός",
                    "scene_description": "Σε ένα συνεργείο, ένας μηχανικός εξηγεί τη σημασία της προγραμματισμένης συντήρησης.",
                    "image_prompt": "8-bit pixel art, συνεργείο συντήρησης με μηχανήματα. Ένας μηχανικός NPC στέκει δίπλα σε μια μηχανή (που συμβολίζει την εφαρμογή) και σε έναν πίνακα ανακοινώσεων/ημερολόγιο με σημειωμένες προγραμματισμένες ημερομηνίες συντήρησης.",
                    "question": "Τι περιλαμβάνει ο προγραμματισμός συντήρησης;",
                    "options": [
                        "Μόνο τακτικές ενημερώσεις, όπως προγραμματισμένες αναβαθμίσεις και βελτιστοποιήσεις, χωρίς να λαμβάνεται υπόψη η ανάγκη για έκτακτη συντήρηση ή κοινοποίηση του χρονοδιαγράμματος στους χρήστες",
                        "Προγραμματισμένη συντήρηση (τακτικές ενημερώσεις, αναβαθμίσεις, βελτιστοποιήσεις) και έκτακτη συντήρηση (κρίσιμες ευπάθειες, προβλήματα) με σαφή χρονοδιάγραμμα που κοινοποιείται εγκαίρως",
                        "Μόνο έκτακτη συντήρηση, που αφορά την άμεση αντιμετώπιση κρίσιμων ευπαθειών ή προβλημάτων, χωρίς να υπάρχει προγραμματισμός ή ενημέρωση των χρηστών για τις ενέργειες που θα πραγματοποιηθούν",
                        "Δεν απαιτείται προγραμματισμός, καθώς οι εφαρμογές μπορούν να συντηρούνται όποτε προκύψει ανάγκη, χωρίς να ακολουθείται συγκεκριμένο χρονοδιάγραμμα ή διαδικασία"
                    ],
                    "correct_answer": 1,
                    "explanation": "Προγραμματισμένη συντήρηση (τακτικές ενημερώσεις, αναβαθμίσεις, βελτιστοποιήσεις) και έκτακτη συντήρηση (κρίσιμες ευπάθειες, προβλήματα) με σαφή χρονοδιάγραμμα που κοινοποιείται εγκαίρως."
                },
                {
                    "id": 18,
                    "scene_title": "Κέντρο Ελέγχου - Διαχείριση Αλλαγών",
                    "scene_description": "Σε μια αίθουσα ελέγχου, ένας μηχανικός δοκιμάζει αλλαγές σε test περιβάλλον πριν το production.",
                    "image_prompt": "8-bit pixel art, αίθουσα ελέγχου τεχνολογίας. Ένας μηχανικός NPC σε κονσόλα είναι έτοιμος να εφαρμόσει μια αλλαγή λογισμικού, πρώτα όμως τη δοκιμάζει σε έναν ξεχωριστό δοκιμαστικό server που είναι πιστό αντίγραφο του παραγωγικού (υπάρχει πινακίδα \"Test Environment\"), ενώ μια ασφαλισμένη πόρτα με την ένδειξη \"Production\" βρίσκεται πιο πέρα.",
                    "question": "Ποια είναι τα βήματα μιας ασφαλούς διαδικασίας διαχείρισης αλλαγών;",
                    "options": [
                        "Άμεση εφαρμογή αλλαγών στο production χωρίς δοκιμή, χωρίς αξιολόγηση επιπτώσεων ή διατήρηση ιστορικού αλλαγών, γεγονός που μπορεί να οδηγήσει σε απώλεια δεδομένων ή διακοπή λειτουργίας",
                        "Αυστηρή αξιολόγηση επιπτώσεων, δοκιμή σε περιβάλλον που αντιγράφει το παραγωγικό, διατήρηση ιστορικού αλλαγών και δυνατότητα άμεσης επαναφοράς",
                        "Εφαρμογή αλλαγών τα Σαββατοκύριακα χωρίς δοκιμή, ώστε να ελαχιστοποιείται η επίδραση στους χρήστες, χωρίς να διασφαλίζεται η ασφάλεια ή η συνέχεια της λειτουργίας",
                        "Δοκιμή μόνο στο production, χωρίς να προηγείται αξιολόγηση επιπτώσεων ή διατήρηση ιστορικού αλλαγών, με κίνδυνο να προκληθούν προβλήματα σε πραγματικό χρόνο"
                    ],
                    "correct_answer": 1,
                    "explanation": "Αυστηρή αξιολόγηση επιπτώσεων, δοκιμή σε περιβάλλον που αντιγράφει το παραγωγικό, διατήρηση ιστορικού αλλαγών και δυνατότητα άμεσης επαναφοράς."
                },
                {
                    "id": 19,
                    "scene_title": "Αίθουσα Συσκέψεων - Προϋποθέσεις Έργου",
                    "scene_description": "Σε μια αίθουσα συσκέψεων, διάφοροι stakeholders συζητούν τις απαιτήσεις ασφάλειας του έργου.",
                    "image_prompt": "8-bit pixel art, αίθουσα συσκέψεων με ένα μεγάλο στρογγυλό τραπέζι. Ένας διευθυντής έργου NPC στέκεται όρθιος με μια λίστα που τιτλοφορείται \"Απαιτήσεις Ασφαλείας\" πάνω στο τραπέζι. Γύρω κάθονται διάφοροι συμμετέχοντες NPC – ένας προγραμματιστής, ένας υπεύθυνος ασφαλείας, ένας εκπρόσωπος δημοσίου φορέα, ακόμα και ένας πολίτης-χρήστης – όλοι συμμετέχουν στη συζήτηση.",
                    "question": "Ποιες είναι οι βασικές προϋποθέσεις για μια επιτυχημένη διαχείριση έργου ασφαλείας στον δημόσιο τομέα;",
                    "options": [
                        "Σαφής καθορισμός απαιτήσεων ασφαλείας, συμμετοχή όλων των ενδιαφερόμενων μερών από την αρχή, ομάδα έργου με σαφείς ρόλους και τακτικές συναντήσεις παρακολούθησης προόδου",
                        "Μόνο συμμετοχή προγραμματιστών, χωρίς να λαμβάνονται υπόψη οι ανάγκες των υπόλοιπων ενδιαφερόμενων μερών ή να καθορίζονται σαφείς ρόλοι και διαδικασίες παρακολούθησης",
                        "Μόνο καθορισμός απαιτήσεων στο τέλος του έργου, χωρίς να υπάρχει συμμετοχή όλων των ενδιαφερόμενων μερών ή τακτικές συναντήσεις για την παρακολούθηση της προόδου",
                        "Δεν υπάρχουν προϋποθέσεις, καθώς η επιτυχία ενός έργου ασφαλείας εξαρτάται αποκλειστικά από την τεχνολογική υλοποίηση και όχι από τη διαχείριση ή τη συνεργασία των ομάδων"
                    ],
                    "correct_answer": 0,
                    "explanation": "Σαφής καθορισμός απαιτήσεων ασφαλείας, συμμετοχή όλων των ενδιαφερόμενων μερών από την αρχή, ομάδα έργου με σαφείς ρόλους και τακτικές συναντήσεις παρακολούθησης προόδου."
                },
                {
                    "id": 20,
                    "scene_title": "Ασφαλής Πόλη - Ολοκληρωμένη Προσέγγιση",
                    "scene_description": "Στη φωτεινή πόλη του μέλλοντος, οι πολίτες χρησιμοποιούν με εμπιστοσύνη τις ασφαλείς ψηφιακές υπηρεσίες.",
                    "image_prompt": "8-bit pixel art, μια φωτεινή ψηφιακή πόλη του μέλλοντος. Ένας διάφανος θόλος-ασπίδα με εικονίδιο κλειδαριάς προστατεύει την πόλη, συμβολίζοντας την ασφάλεια. Πολίτες-χαρούμενοι NPCs κινούνται στην πόλη χρησιμοποιώντας υπολογιστές και ψηφιακές υπηρεσίες με χαμόγελο εμπιστοσύνης.",
                    "question": "Ποιος είναι ο στόχος της ολοκληρωμένης προσέγγισης ασφαλείας για τον δημόσιο τομέα;",
                    "options": [
                        "Η αύξηση του κόστους ανάπτυξης, ώστε να διασφαλιστεί ότι οι ψηφιακές υπηρεσίες του δημοσίου πληρούν τα υψηλότερα πρότυπα ασφάλειας και εμπιστοσύνης για τους πολίτες",
                        "Η δημιουργία αξιόπιστων, ασφαλών ψηφιακών υπηρεσιών που διατηρούν την εμπιστοσύνη των πολιτών, συμμορφώνονται με το νομικό πλαίσιο και διασφαλίζουν την επιχειρησιακή συνέχεια των κρίσιμων δημόσιων λειτουργιών",
                        "Η μείωση της λειτουργικότητας των ψηφιακών υπηρεσιών, προκειμένου να ενισχυθεί η ασφάλεια και να περιοριστούν οι δυνατότητες πρόσβασης των πολιτών σε ευαίσθητα δεδομένα",
                        "Η πολυπλοκότητα στη χρήση των ψηφιακών υπηρεσιών, ώστε να αποτρέπεται η μη εξουσιοδοτημένη πρόσβαση και να διασφαλίζεται η προστασία των προσωπικών δεδομένων των πολιτών"
                    ],
                    "correct_answer": 1,
                    "explanation": "Η δημιουργία αξιόπιστων, ασφαλών ψηφιακών υπηρεσιών που διατηρούν την εμπιστοσύνη των πολιτών, συμμορφώνονται με το νομικό πλαίσιο και διασφαλίζουν την επιχειρησιακή συνέχεια των κρίσιμων δημόσιων λειτουργιών."
                }
            ];
            
            // Shuffle questions for variety
            this.shuffleArray(this.questions);
            
        } catch (error) {
            console.error('Failed to load questions:', error);
            // Handle error, e.g., show an error message to the user
            this.showError('Απέτυχε η φόρτωση των ερωτήσεων.');
        }
    }
    
    shuffleArray(array) {
        for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
        }
    }
    
    initializeElements() {
        // Screen elements
        this.screens = {
            start: document.getElementById('startScreen'),
            game: document.getElementById('gameScreen'),
            end: document.getElementById('endScreen'),
            loading: document.getElementById('loadingScreen')
        };
        
        // Start screen elements
        this.startButton = document.getElementById('startButton');
        
        // Game screen elements
        this.currentQuestionSpan = document.getElementById('currentQuestion');
        this.totalQuestionsSpan = document.getElementById('totalQuestions');
        this.currentScoreSpan = document.getElementById('currentScore');
        this.progressFill = document.getElementById('progressFill');
        this.sceneTitle = document.getElementById('sceneTitle');
        this.sceneLocation = document.getElementById('sceneLocation');
        this.sceneImage = document.getElementById('sceneImage');
        this.npcName = document.getElementById('npcName');
        this.npcDescription = document.getElementById('npcDescription');
        this.questionText = document.getElementById('questionText');
        this.optionsContainer = document.getElementById('optionsContainer');
        this.submitButton = document.getElementById('submitAnswer');
        this.nextButton = document.getElementById('nextQuestion');
        this.feedbackContainer = document.getElementById('feedbackContainer');
        this.feedbackResult = document.getElementById('feedbackResult');
        this.feedbackExplanation = document.getElementById('feedbackExplanation');
        
        // End screen elements are now handled in endpage.html
        // Removed references to elements that no longer exist in index.html
        
        // Set total questions
        this.totalQuestionsSpan.textContent = this.questions.length;
    }
    
    setupEventListeners() {
        // Start button
        this.startButton.addEventListener('click', () => this.startGame());
        
        // Submit answer button
        this.submitButton.addEventListener('click', () => this.submitAnswer());
        
        // Next question button
        this.nextButton.addEventListener('click', () => this.nextQuestion());
        
        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => this.handleKeyboard(e));
    }
    
    handleKeyboard(event) {
        if (this.gameState !== 'playing') return;
        
        // Number keys 1-4 for answers
        if (event.key >= '1' && event.key <= '4') {
            const optionIndex = parseInt(event.key) - 1;
            const optionButton = this.optionsContainer.children[optionIndex];
            if (optionButton) {
                this.selectOption(optionIndex);
            }
        }
        
        // Enter to submit answer
        if (event.key === 'Enter' && !this.submitButton.disabled) {
            this.submitAnswer();
        }
        
        // Space or Enter to go to next question
        if ((event.key === ' ' || event.key === 'Enter') && this.nextButton.style.display !== 'none') {
            event.preventDefault();
            this.nextQuestion();
        }
    }
    
    showScreen(screenName) {
        // Hide all screens
        Object.values(this.screens).forEach(screen => {
            if (screen) {
                screen.classList.remove('active');
            }
        });
        
        // Show selected screen
        if (this.screens[screenName]) {
            this.screens[screenName].classList.add('active');
        } else {
            console.error('Screen not found:', screenName);
        }
        
        // Update game state
        this.gameState = screenName === 'game' ? 'playing' : screenName;
        
        // Play screen transition sound
        if (window.AudioManager) {
            window.AudioManager.playTransition();
        }
    }
    
    startGame() {
        this.showScreen('loading');
        
        // Reset game state
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.userAnswers = [];
        this.selectedAnswer = null;
        
        // Start background music
        if (window.AudioManager) {
            window.AudioManager.startBackgroundMusic();
        }
        
        // Show first question after loading
        setTimeout(() => {
            this.showScreen('game');
            this.displayQuestion();
        }, 1500);
    }
    
    displayQuestion() {
        const question = this.questions[this.currentQuestionIndex];
        
        // Update progress
        this.updateProgress();
        
        // Update scene information
        this.sceneTitle.textContent = question.scene_title;
        this.sceneLocation.textContent = `📍 ${question.scene_description}`;
        this.npcName.textContent = question.scene_title;
        this.npcDescription.textContent = question.scene_description;
        
        // Set scene image based on question ID
        const imageFilename = `scene_${question.id.toString().padStart(2, '0')}.png`;
        this.sceneImage.src = `images/${imageFilename}`;
        this.sceneImage.alt = question.scene_title;
        
        // Display question
        this.questionText.textContent = question.question;
        
        // Display options
        this.displayOptions(question.options);
        
        // Reset UI state
        this.selectedAnswer = null;
        this.submitButton.disabled = true;
        this.submitButton.style.display = 'block';
        this.nextButton.style.display = 'none';
        this.feedbackContainer.style.display = 'none';
        
        // Play question sound
        if (window.AudioManager) {
            window.AudioManager.playQuestionSound();
        }
    }
    
    displayOptions(options) {
        this.optionsContainer.innerHTML = '';
        
        options.forEach((option, index) => {
            const button = document.createElement('button');
            button.className = 'option-button';
            button.setAttribute('data-option', index);
            
            const letter = document.createElement('span');
            letter.className = 'option-letter';
            letter.textContent = String.fromCharCode(65 + index); // A, B, C, D
            
            const text = document.createElement('span');
            text.className = 'option-text';
            text.textContent = option;
            
            button.appendChild(letter);
            button.appendChild(text);
            
            button.addEventListener('click', () => this.selectOption(index));
            
            this.optionsContainer.appendChild(button);
        });
    }
    
    selectOption(optionIndex) {
        if (this.feedbackContainer.style.display === 'block') return;
        
        // Remove previous selection
        this.optionsContainer.querySelectorAll('.option-button').forEach(btn => {
            btn.classList.remove('selected');
        });
        
        // Add selection to clicked option
        const selectedButton = this.optionsContainer.children[optionIndex];
        selectedButton.classList.add('selected');
        
        this.selectedAnswer = optionIndex;
        this.submitButton.disabled = false;
        
        // Play selection sound
        if (window.AudioManager) {
            window.AudioManager.playSelectSound();
        }
    }
    
    submitAnswer() {
        if (this.selectedAnswer === null) return;
        
        const question = this.questions[this.currentQuestionIndex];
        const isCorrect = this.selectedAnswer === question.correct_answer;
        
        // Store answer
        this.userAnswers.push(isCorrect);
        
        // Update score
        if (isCorrect) {
            this.score++;
            this.updateScore();
        }
        
        // Show feedback
        this.showFeedback(isCorrect, question);
        
        // Update UI
        this.submitButton.style.display = 'none';
        this.nextButton.style.display = 'block';
        
        // Play feedback sound
        if (window.AudioManager) {
            if (isCorrect) {
                window.AudioManager.playCorrectSound();
            } else {
                window.AudioManager.playIncorrectSound();
            }
        }
    }
    
    showFeedback(isCorrect, question) {
        // Update option buttons
        this.optionsContainer.querySelectorAll('.option-button').forEach((btn, index) => {
            btn.disabled = true;
            
            if (index === question.correct_answer) {
                btn.classList.add('correct');
            } else if (index === this.selectedAnswer && !isCorrect) {
                btn.classList.add('incorrect');
            }
        });
        
        // Show feedback container
        this.feedbackContainer.style.display = 'block';
        
        // Update feedback content
        this.feedbackResult.textContent = isCorrect ? '✅ Σωστή Απάντηση!' : '❌ Λάθος Απάντηση';
        this.feedbackResult.className = `feedback-result ${isCorrect ? 'correct' : 'incorrect'}`;
        this.feedbackExplanation.textContent = question.explanation;
    }
    
    nextQuestion() {
        this.currentQuestionIndex++;
        
        if (this.currentQuestionIndex < this.questions.length) {
            this.displayQuestion();
        } else {
            this.endGame();
        }
    }
    
    updateProgress() {
        const progress = ((this.currentQuestionIndex + 1) / this.questions.length) * 100;
        this.progressFill.style.width = `${progress}%`;
        this.currentQuestionSpan.textContent = this.currentQuestionIndex + 1;
    }
    
    updateScore() {
        this.currentScoreSpan.textContent = this.score;
    }
    
    endGame() {
        // Redirect to the end page with the score as a URL parameter
        window.location.href = `endpage.html?score=${this.score}`;
    }
    
    showError(message) {
        const errorDiv = document.createElement('div');
        errorDiv.style.cssText = `
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--destructive);
            color: var(--destructive-foreground);
            padding: 20px;
            border-radius: 10px;
            font-family: 'Orbitron', monospace;
            z-index: 1000;
        `;
        errorDiv.textContent = message;
        document.body.appendChild(errorDiv);
        
        setTimeout(() => {
            document.body.removeChild(errorDiv);
        }, 3000);
    }
}

// Initialize game when DOM is loaded
document.addEventListener('DOMContentLoaded', () => {
    window.game = new SecurityQuest();
}); 